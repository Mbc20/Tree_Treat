DECLARE
C NUMBER;
BEGIN
SELECT COUNT(*) INTO C FROM BUYER;
C:=C+1;
--DBMS_OUTPUT.PUT_LINE(C) ;

END;

-----------

DECLARE
L VARCHAR2(100);
BEGIN
SELECT LOCATION_ID INTO L FROM SELLER_LOCATION 
WHERE UPPER(DISTRICT)='RAJSHAHI' AND UPPER(THANA)='BOGURA SADAR' AND UPPER(AREA)='MALOTINOGOR' AND UPPER(DETAILS)='ROAD NO - 5';
--DBMS_OUTPUT.PUT_LINE(L) ;
END;

------------

SELECT PRODUCT_ID ,PRODUCT_NAME, AVAILABLE_QUANTITY FROM PRODUCT
WHERE LOWER(CATEGORY)='plant';


-----------


SELECT S.NAME, S.EMAIL, S.CONTACT, L.DISTRICT, L.THANA, L.AREA, L.DETAILS 
FROM SELLER S JOIN SELLER_LOCATION L ON (S.LOCATION_ID=L.LOCATION_ID) 
WHERE S.EMAIL='ritu2200@gmail.com' AND S.PASSWORD='ri252ta';


------------

SELECT P.PRODUCT_NAME, P.AVAILABLE_QUANTITY, C.PRICE
FROM PRODUCT P JOIN COMMERCIAL C ON (P.PRODUCT_ID=C.PRODUCT_ID)
WHERE P.CATEGORY='plant';


---------------

SELECT P.PRODUCT_NAME, P.AVAILABLE_QUANTITY
FROM PRODUCT P JOIN GIFT G ON (P.PRODUCT_ID=G.PRODUCT_ID)
WHERE P.CATEGORY='plant';

-------

DELETE FROM BUYER WHERE BUYER_ID=2;

----------

DECLARE
C NUMBER;
BEGIN
SELECT MAX(BUYER_ID) INTO C FROM BUYER;
C:=C+1;
DBMS_OUTPUT.PUT_LINE(C);
END;


DECLARE
C NUMBER;
BEGIN
SELECT MAX(BUYER_ID) INTO C FROM BUYER;
C:=C+1;
INSERT INTO BUYER (BUYER_ID, NAME, EMAIL, PASSWORD, CONTACT) VALUES (C,'adiba','adiba@gmail.com','123ad','01234567896');
COMMIT;
END;

--------

select * from SELLER_LOCATION where DISTRICT='Rangpur';

--------







DROP TRIGGER NEW_LOCATION;


----------

SELECT P.PRODUCT_ID, P.PRODUCT_NAME, P.AVAILABLE_QUANTITY, C.PRICE
        FROM PRODUCT P JOIN COMMERCIAL C ON (P.PRODUCT_ID=C.PRODUCT_ID)
        WHERE P.CATEGORY='plant';


-----------

SELECT P.PRODUCT_ID, P.PRODUCT_NAME ,P.AVAILABLE_QUANTITY
FROM PRODUCT P JOIN GIFT G
ON P.PRODUCT_ID = G.PRODUCT_ID
WHERE P.CATEGORY = 'plant' AND INSTR(UPPER(P.PRODUCT_NAME),UPPER('ang'))>0 ;


-----------

SELECT P.PRODUCT_ID, P.PRODUCT_NAME, P.AVAILABLE_QUANTITY, C.PRICE
FROM PRODUCT P JOIN COMMERCIAL C
ON P.PRODUCT_ID = C.PRODUCT_ID
WHERE P.CATEGORY ='plant' AND INSTR(UPPER(P.PRODUCT_NAME),UPPER('flower'))>0 ;


--------------
SELECT P.PRODUCT_NAME, M.PRICE, P.AVAILABLE_QUANTITY
FROM COMMERCIAL_OWNER C JOIN PRODUCT P ON (C.PRODUCT_ID=P.PRODUCT_ID) JOIN COMMERCIAL M ON (P.PRODUCT_ID=M.PRODUCT_ID)
WHERE C.SELLER_ID=2;

------- adding to PRODUCT_IN_WISHLIST


CREATE OR REPLACE FUNCTION WISHADD(EM IN VARCHAR2, PASS IN VARCHAR2, PID INTEGER) RETURN VARCHAR2 IS 

BID INTEGER;
CHK NUMBER;
PR FLOAT;
BEGIN
SELECT BUYER_ID INTO BID FROM BUYER WHERE EMAIL=EM AND PASSWORD=PASS;

SELECT COUNT(*) INTO CHK FROM GIFT WHERE PRODUCT_ID=PID; --- IF GIFT, CHK>0(ACTUALLY 1), ELSE CHK=0

IF CHK>0 THEN ----THIS IS A GIFT
	INSERT INTO PRODUCT_IN_WISHLIST (BUYER_ID, PRODUCT_ID, QUANTITY, PRICE_PER_PIECE, DATE_TIME) VALUES (BID, PID, 1, 0, SYSDATE);
	COMMIT;
ELSE --- THIS IS A COMMERCIAL 
	SELECT PRICE INTO PR FROM COMMERCIAL WHERE PRODUCT_ID=PID;
	INSERT INTO PRODUCT_IN_WISHLIST (BUYER_ID, PRODUCT_ID, QUANTITY, PRICE_PER_PIECE, DATE_TIME) VALUES (BID, PID, 1, PR, SYSDATE);
	COMMIT;
END IF;
RETURN 'product added';
END;
/



DECLARE
M VARCHAR2(50);
BEGIN
M:=WISHADD('tintin@gmail.com', 't2t2', 5);
DBMS_OUTPUT.PUT_LINE(M);
END;

DECLARE
M VARCHAR2(50);
BEGIN
M:=WISHADD('tintin@gmail.com', 't2t2', 6);
DBMS_OUTPUT.PUT_LINE(M);
END;

----

DECLARE
BYRID INTEGER;
BEGIN
SELECT BUYER_ID INTO BYRID FROM BUYER WHERE EMAIL='tintin@gmail.com' AND PASSWORD='t2t2';
DELETE FROM BUYER WHERE BUYER_ID=BYRID;
COMMIT;
END ;

DELETE FROM BUYER WHERE BUYER_ID=53;